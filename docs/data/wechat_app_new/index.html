<!DOCTYPE html>
<html lang="en">
    <head>
            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            
            
            
            <link rel="shortcut icon" href="../../img/favicon.ico">
            <title>Bmob文档中心</title>
            <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
            <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
            <link href="../../css/base.css" rel="stylesheet">
            <link rel="stylesheet" href="../../css/highlight.css">
            <link href="../../css/agate.css" rel="stylesheet">
            <link href="../../css/custom.css" rel="stylesheet" id="custom">
    </head>

    <body >

        <div class="navbar navbar-fixed-top" role="navigation">
    <div class="main-nav">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <a class="navbar-brand" href="../..">
                <!--Bmob文档中心-->
                <img src="../../img/logo.png" alt="">
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">

          <ul class="nav navbar-nav">
            
              <li class="pull-left">
                
					<a href="../..">文档首页</a>
                
              </li>
            
              <li class="pull-left active">
                
					<!--<a href="">数据服务</a>-->
					<li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">数据服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../android/">Android</a>
                                </li>
                            
                            
								<li >
									<a href="../ios/">iOS</a>
                                </li>
                            
                            
								<li >
									<a href="../csharp/">C#</a>
                                </li>
                            
                            
								<li >
									<a href="../php/">PHP</a>
                                </li>
                            
                            
								<li >
									<a href="../go/">GO</a>
                                </li>
                            
                            
								<li >
									<a href="../restful/">RESTful</a>
                                </li>
                            
                            
								<li >
									<a href="../javascript/">JavaScript</a>
                                </li>
                            
                            
                                <li >
                                    <a href="../cocos2d_x/">Cocos2D-X</a>
                                </li>
							
                            
								<li >
									<a href="../wechat_app/">小程序</a>
                                </li>
                            
                            
                                <li >
                                    <a href="./">快应用</a>
                                </li>
							
                            
                                <li >
                                    <a href="./">Nodejs</a>
                                </li>
							
                            
                                <li >
                                    <a href="./">Cocos Creator</a>
                                </li>
							
                            
                                <li class="active">
                                    <a href="./">小程序(新)</a>
                                </li>
							
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="../../cloud_function/android/">云函数</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">云函数 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                                <li >
                                    <a href="../../cloud_function/android/">Android</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/ios/">iOS</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/java/">Java</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/csharp/">C#</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/php/">PHP</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/javascript/">JavaScript</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../cloud_function/restful/">RESTful</a>
                                </li>
							
                            
								<li >
									<a href="../../cloud_function/web/">Web</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="../../sms/android/">短信服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">短信服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                                <li >
                                    <a href="../../sms/android/">Android</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../sms/ios/">iOS</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../sms/php/">PHP</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../sms/javascript/">JavaScript</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../sms/restful/">RESTful</a>
                                </li>
							
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">IM服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">IM服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../im/android/">Android</a>
                                </li>
                            
                            
								<li >
									<a href="../../im/ios/">iOS</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="../../push/android/">推送服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">推送服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                                <li >
                                    <a href="../../push/android/">Android</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../push/ios/">iOS</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../push/php/">PHP</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../push/javascript/">JavaScript</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../push/restful/">RESTful</a>
                                </li>
							
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="../../other/common_problem/">其他</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">其他 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
                                <li >
                                    <a href="../../other/common_problem/">常见问题</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../other/error_code/">错误码</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../other/data_safety/">数据安全</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../other/bql/">BQL</a>
                                </li>
							
                        </ul>
                    </li>
                
              </li>
            
              <li>
                  <a href="https://www.bmob.cn/repository/index" target="_blank">知识库</a>
              </li>
              <li>
                  <a href="http://doc.bmob.cn/video/index.html" target="_blank">视频教程</a>
              </li>
            </ul>
            
        </div>
    </div>
</div>

        <div class="pagebody" id="main-wrapper">
            <div class="sidebar">
                <div class="bs-sidebar hidden-print affix well" role="complementary">

	
		
	
		
				
				
				
				
				
				
				
				
				
				
				
				
				
					<div class="code-title">小程序(新)</div>
				
		
	
		
				
				
				
				
				
				
				
				
		
	
		
				
				
				
				
				
		
	
		
				
				
		
	
		
				
				
				
				
				
		
	
		
				
				
				
				
		
	


	<ul class="nav bs-sidenav">
		
			
		
			
				
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
							
								
									
										<li class="active "><a href="#sdk">SDK使用文档</a>
											
										</li>
									
										<li class=""><a href="#_1">安装使用</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_2">下载</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_3">安装使用</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_4">初始化</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_5">用户操作</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_6">登陆</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_7">注册</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_8">手机验证码登陆</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_9">查询用户</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_10">获取用户登录信息</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#email">验证 Email</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_11">密码重置</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#app">APP推送</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_12">数据表操作</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_13">获取一行记录</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_14">新增一行记录</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_15">修改一行记录</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_16">删除字段的值</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_17">删除一行记录</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_18">查询所有数据</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_19">条件查询</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_20">数据库批量操作</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_21">批量修改</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_22">批量增加</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_23">批量删除</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_24">数据关联</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#pointer">Pointer的使用</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#relation">Relation的使用</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_25">数组操作</a>
											
										</li>
									
										<li class=""><a href="#_26">云函数使用</a>
											
										</li>
									
										<li class=""><a href="#_27">文件</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#web">WEB文件上传</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_28">小程序文件上传</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#file">file对象关联</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_29">文件删除</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_30">小程序操作</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_31">小程序一键登录</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_32">小程序更新用户信息</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_33">生成二维码</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#access_token">获取access_token</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_34">小程序模版消息</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_35">小程序付款到零钱</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_36">小程序支付</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_37">小程序退款</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_38">微信主人通知</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_40">小程序下载域名</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_41">小程序客服消息</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#websocket">小程序WebSocket</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#js">使用实时数据平台的js</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_42">订阅事件</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_46">取消订阅事件</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_50">监听触发的事件</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#demo">demo</a></li>
											</ul>
											
										</li>
									
										<li class=""><a href="#_54">短信服务操作</a>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_55">请求短信验证码</a></li>
											</ul>
											
											<ul class="nav nav-l2">
												<li><a class="itm-l2" href="#_56">验证短信验证码</a></li>
											</ul>
											
										</li>
									
								
							
						
					
				
			
		
			
		
			
		
			
		
			
		
			
		
	</ul>
</div>
            </div>
            <div class="content" role="main">
                <div class="wrap">
                    

<h2 id="sdk">SDK使用文档<a class="headerlink" href="#sdk" title="Permanent link">&para;</a></h2>
<h2 id="_1">安装使用<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">下载<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<blockquote>
<p>https://github.com/bmob/hydrogen-js-sdk/</p>
</blockquote>
<h3 id="_3">安装使用<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<ol>
<li>整个SDK，就dist目录下Bmob.*.js 这个文件即可使用全部功能</li>
<li>目前支持微信小程序、H5、快应用、游戏Cocos、混合App等</li>
</ol>
<p><strong>引入：</strong></p>
<pre><code>var Bmob = require('../dist/Bmob-1.0.1.min.js');
</code></pre>

<h3 id="_4"><strong>初始化</strong><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<pre><code>Bmob.initialize(&quot;你的Application ID&quot;, &quot;你的REST API Key&quot;);
</code></pre>

<blockquote>
<p>接下来就可参照下面的文档使用,</p>
<p><code>nodejs</code>请使用源码引入 app.js ，初始化与其他一样</p>
</blockquote>
<pre><code>var Bmob = require('./src/lib/app.js');
</code></pre>

<h2 id="_5">用户操作<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">登陆<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过用户名密码登陆，登陆成功后会在本地缓存保存用户的信息</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>string</td>
<td>是</td>
<td>用户名</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>是</td>
<td>密码</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code> Bmob.User.login('username','password').then(res =&gt; {
   console.log(res)
 }).catch(err =&gt; {
  console.log(err)
});
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
    &quot;createdAt&quot;:&quot;2018-04-19 17:26:45&quot;,
    &quot;objectId&quot;:&quot;X43SIIIH&quot;,
    &quot;sessionToken&quot;:&quot;cc4fbcfd40583af980f4e6e52085adbf&quot;,
    &quot;updatedAt&quot;:&quot;2018-04-19 17:26:48&quot;,
    &quot;username&quot;:&quot;aaaaaa&quot;
}
失败：
{&quot;code&quot;:101,&quot;error&quot;:&quot;username or password incorrect.&quot;}
</code></pre>

<h3 id="_7">注册<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过用户名密码注册</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>string</td>
<td>是</td>
<td>用户名</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>是</td>
<td>密码</td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>是</td>
<td>邮箱</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>否</td>
<td>手机</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let params = {
    username: 'bmob2018',
    password: 'bmob2018',
    email: 'bmob2018@bmob.cn',
    phone: '13711166567',
}
Bmob.User.register(params).then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
 console.log(err)
});
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
    &quot;createdAt&quot;:&quot;2018-04-19 17:42:59&quot;,
    &quot;objectId&quot;:&quot;73d4587140&quot;,
    &quot;sessionToken&quot;:&quot;14683f9a40b2509d80320bf0d4ec7d6e&quot;
}
失败：
{&quot;code&quot;:107,&quot;error&quot;:&quot;content is empty.&quot;}
</code></pre>

<h3 id="_8">手机验证码登陆<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>手机号码和验证码一键快速登录的功能，而 <strong>smsCode</strong> 是调用短信请求验证码函数</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>phone</td>
<td>Number</td>
<td>是</td>
<td>用户名</td>
</tr>
<tr>
<td>smsCode</td>
<td>Number</td>
<td>是</td>
<td>密码</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.User.signOrLoginByMobilePhone(phone,smsCode).then(res =&gt; {
 console.log(res)
}).catch(err =&gt; {
 console.log(err)
});
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
  &quot;username&quot;: username,
  &quot;mobilePhoneNumber&quot;: mobilePhoneNumber,
  &quot;mobilePhoneVerified&quot;: boolValue,
  &quot;createdAt&quot;: YYYY-mm-dd HH:ii:ss,
  &quot;updatedAt&quot;: YYYY-mm-dd HH:ii:ss,
  &quot;objectId&quot;: objectId,
  &quot;sessionToken&quot;: sessionToekn,
  key1:value1,
  key2:value2,
  ...
}
失败：
{&quot;code&quot;:207,&quot;error&quot;:&quot;code error.&quot;}
</code></pre>

<h3 id="_9">查询用户<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>你可以一次获取多个用户，只要向用户的根URL发送一个GET请求，没有任何URL参数的话，可以简单地列出100个用户。</p>
<p>所有的对普通对象的查询选项都适用于对用户对象的查询，所以可以查看 查询 部分来获取详细信息。</p>
<p>User表是一个特殊的表，专门用于存储用户对象。在浏览器端，你会看到一个User表旁边有一个小人的图标。</p>
<p><strong>参数说明：</strong></p>
<p>无需参数</p>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.User.users().then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
    results: [
        {createdAt: &quot;2018-04-19 17:26:45&quot;, objectId: &quot;X43SIIIH&quot;, updatedAt: &quot;2018-04-19 17:26:48&quot;,…}
        {createdAt: &quot;2018-04-19 17:42:59&quot;, email: &quot;bmob2018@bmob.cn&quot;, objectId: &quot;73d4587140&quot;,…}
    ]
}
</code></pre>

<h3 id="_10">获取用户登录信息<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>此函数获取本地缓存用户信息，登陆后才有值，使用值前请先判断是否为空。</p>
<pre><code>//获取用户当前信息
let current = Bmob.User.current()

//由于快应用新推出暂时不支持同步获取，如果是快应用请用以下写法
Bmob.User.current().then(result =&gt; {
      console.log(result)
    }).catch(err =&gt; {
      console.log(err)
    })
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
    &quot;createdAt&quot;:&quot;2018-04-19 17:26:45&quot;,
    &quot;objectId&quot;:&quot;X43SIIIH&quot;,
    &quot;sessionToken&quot;:&quot;cc4fbcfd40583af980f4e6e52085adbf&quot;,
    &quot;updatedAt&quot;:&quot;2018-04-19 17:26:48&quot;,
    &quot;username&quot;:&quot;aaaaaa&quot;
}
失败：
{&quot;code&quot;:101,&quot;error&quot;:&quot;username or password incorrect.&quot;}

</code></pre>

<h3 id="email">验证 Email<a class="headerlink" href="#email" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>设置邮件验证是一个可选的应用设置, 这样可以对已经确认过邮件的用户提供一部分保留的体验，邮件验证功能会在用户(User)对象中加入emailVerified字段, 当一个用户的邮件被新添加或者修改过的话，emailVerified会默认被设为false，如果应用设置中开启了邮箱认证功能，<a href="http://www.bmob.cn/">Bmob</a>会对用户填写的邮箱发送一个链接, 这个链接可以把emailVerified设置为 true.</p>
<p>emailVerified 字段有 3 种状态可以考虑：</p>
<p><strong>true</strong> : 用户可以点击邮件中的链接通过<a href="http://www.bmob.cn/">Bmob</a>来验证地址，一个用户永远不会在新创建这个值的时候出现emailVerified为true。</p>
<p><strong>false</strong> : 用户(User)对象最后一次被刷新的时候, 用户并没有确认过他的邮箱地址, 如果你看到emailVerified为false的话，你可以考虑刷新 用户(User)对象。</p>
<p><strong>missing</strong> : 用户(User)对象已经被创建，但应用设置并没有开启邮件验证功能； 或者用户(User)对象没有email邮箱。</p>
<p>发送到用户邮箱验证的邮件会在一周内失效</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>email</td>
<td>string</td>
<td>是</td>
<td>邮箱</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.User.requestEmailVerify('bmob2018@bmob.cn').then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
 console.log(err)
});
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
  &quot;msg&quot;: &quot;ok&quot;
}
失败：
{code: 120, error: &quot;Email verify should be opened in your app setup page of bmob.&quot;}
</code></pre>

<h3 id="_11">密码重置<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>共提供了3种方法，分别是email重置、短信验证码重置、旧密码重置。</p>
<p>Eamil密码重置</p>
<p><strong>请求描述：</strong>
你可以使用这项功能，前提是用户将email与他们的账户关联起来，如果要重设密码，发送一个POST请求到 /1/requestPasswordReset, 同时在request的body部分带上email字段。</p>
<p>密码重置流程如下：</p>
<p>1.用户输入他们的电子邮件，请求重置自己的密码。</p>
<p>2.Bmob向他们的邮箱发送一封包含特殊的密码重置连接的电子邮件，此邮件的模板可在Bmob后台中修改。</p>
<p>3.用户根据向导点击重置密码连接，打开一个特殊的Bmob页面，输入一个新的密码。</p>
<p>4.用户的密码已被重置为新输入的密码。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>email</td>
<td>string</td>
<td>是</td>
<td>邮箱地址</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let data = {
  email: '329685131@qq.com'
}
Bmob.requestPasswordReset(data).then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
  &quot;msg&quot;: &quot;ok&quot;
}
</code></pre>

<p>短信密码重置</p>
<p><strong>请求描述：</strong>
如果用户有绑定了手机号码，就可以通过手机验证码短信来实现使用手机号码找回密码的功能，先调用 请求短信验证码API会将验证码发送到用户手机上，用户收到验证码并输入后，调用PUT /1/resetPasswordBySmsCode/smsCode 来为用户设置新的密码。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>password</td>
<td>string</td>
<td>是</td>
<td>新密码</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let smsCode= 'smsCode'
let data = {
  password: 'password'
}
Bmob.resetPasswordBySmsCode(smsCode,data).then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
  "msg": "ok"
}
</code></pre>
<p>提供旧密码方式安全修改用户密码</p>
<p><strong>请求描述：</strong>
很多开发者希望让用户输入一次旧密码做一次校验，旧密码正确才可以修改为新密码，因此我们提供了一个单独的 API PUT /1/updatePassword 来安全地修改用户密码。</p>
<p>注意：仍然需要传入 X-Bmob-Session-Token，也就是登录用户才可以修改自己的密码。
<strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>oldPassword</td>
<td>string</td>
<td>是</td>
<td>旧密码</td>
</tr>
<tr>
<td>newPassword</td>
<td>string</td>
<td>是</td>
<td>新密码</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let objectId ='objectId'
let data = {
  oldPassword: 'oldPassword',
  newPassword: 'newPassword'
}
Bmob.updateUserPassword(objectId,data).then(res =&gt; {
    console.log(res)
  }).catch(err =&gt; {
    console.log(err)
  })
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
  "msg": "ok"
}
</code></pre>
<h3 id="app">APP推送<a class="headerlink" href="#app" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>使用推送接口可将消息推送至对应设备。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>object</td>
<td>是</td>
<td>根据不同的需求进行定制</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let data = {
  data: {
alert: "Hello From Bmob."
  }
}

Bmob.push(data).then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>
<p><strong>返回示例:</strong></p>
<p>待补充返回示例</p>
<h2 id="_12">数据表操作<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<h3 id="_13">获取一行记录<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过主键获取一行记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
<tr>
<td>objectId</td>
<td>string</td>
<td>是</td>
<td>记录 ID</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.get('objectId').then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
    &quot;results&quot;:[
        {
            &quot;content&quot;:&quot;试试看&quot;,
            &quot;createdAt&quot;:&quot;2018-04-18 15:25:54&quot;,
            &quot;formId&quot;:&quot;the formId is a mock one&quot;,
            &quot;objectId&quot;:&quot;7ecd253a25&quot;,
            &quot;title&quot;:&quot;新增测试&quot;,
            &quot;updatedAt&quot;:&quot;2018-04-18 15:25:54&quot;
        }
    ]
}
</code></pre>

<h3 id="_14">新增一行记录<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过主键获取一行记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.set("name","Bmob")
query.set("cover","后端云")
query.save().then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    createdAt: &quot;YYYY-mm-dd HH:ii:ss&quot;,
    objectId: &quot;objectId&quot;
}
</code></pre>

<h3 id="_15">修改一行记录<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过主键获取一行记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
<tr>
<td>objectId</td>
<td>string</td>
<td>是</td>
<td>记录 ID</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.get('objectId').then(res =&gt; {
  console.log(res)
  res.set('cover','3333')
  res.save()
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
  &quot;updatedAt&quot;: &quot;YYYY-mm-dd HH:ii:ss&quot;
}
</code></pre>

<h3 id="_16">删除字段的值<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过主键获取一行记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
<tr>
<td>objectId</td>
<td>string</td>
<td>是</td>
<td>记录 ID</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.get('objectId').then(res =&gt; {
  console.log(res)
  res.unset('cover')
  res.save()
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
    updatedAt: &quot;YYYY-mm-dd HH:ii:ss&quot;
}
</code></pre>

<h3 id="_17">删除一行记录<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过主键获取一行记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
<tr>
<td>objectId</td>
<td>string</td>
<td>是</td>
<td>记录 ID</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.destroy('objectId').then(res =&gt; {
  console.log(res)
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>
<p>or</p>
<pre><code>const query = Bmob.Query('tableName');
query.get('objectId').then(res =&gt; {
  res.destroy().then(res =&gt; {
console.log(res)
  }).ctach(err =&gt; {
console.log(err)
  })
}).catch(err =&gt; {
  console.log(err)
})
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
  msg: &quot;ok&quot;
}
</code></pre>

<h3 id="_18">查询所有数据<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>返回你表的数据列表，默认创建时间排序，默认取100条数据，下面文档可以增加条件。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
<tr>
<td>res</td>
<td>string</td>
<td>是</td>
<td>返回的数据集合</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query(&quot;tableName&quot;);
query.find().then(res =&gt; {
    console.log(res)
});
</code></pre>

<p><strong>返回： </strong></p>
<p>表中数据</p>
<h3 id="_19">条件查询<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>// 如果要查询某个属性等于某个值，示例代码如下：
query.equalTo(&quot;isLike&quot;, &quot;==&quot;, 100);

// 如果要查询某个属性不等于某个值，示例代码如下：
query.equalTo(&quot;title&quot;, &quot;!=&quot;, &quot;bmob sdk&quot;);

// 如果要模糊查询某个值，示例代码如下（模糊查询目前只提供给付费套餐会员使用）：
query.equalTo(&quot;title&quot;,&quot;==&quot;, { &quot;$regex&quot;: &quot;&quot; + k + &quot;.*&quot; });

// 查询大于某个日期的数据，示例代码如下
query.equalTo(&quot;createdAt&quot;, &quot;&gt;&quot; &quot;2018-08-21 18:02:52&quot;);

/**
* equalTo 方法支持 &quot;==&quot;,&quot;!=&quot;,&quot;&gt;&quot;,&quot;&gt;=&quot;,&quot;&lt;&quot;,&quot;&lt;=&quot;
*/

</code></pre>

<p>两条查询语句一起写，就相当于AND查询，如下示例代码，查询一个月的数据：</p>
<pre><code>query.equalTo(&quot;createdAt&quot;, &quot;&gt;&quot;, &quot;2018-04-01 00:00:00&quot;);
query.equalTo(&quot;createdAt&quot;, &quot;&lt;&quot;, &quot;2018-05-01 00:00:00&quot;);

// 因为createdAt updatedAt服务器自动生成的时间，在服务器保存的是精确到微秒值的时间，所以基于时间类型比较的值要加1秒。

</code></pre>

<p>一个完整的例子</p>
<pre><code>const query = Bmob.Query(&quot;tableName&quot;);
query.equalTo(&quot;title&quot;,&quot;==&quot;, &quot;hello&quot;);
query.find().then(res =&gt; {
    console.log(res)
});
</code></pre>

<p><strong>或查询</strong></p>
<p>你可以使用<code>or</code>方法操作或查询，示例代码如下：</p>
<pre><code>const query = Bmob.Query(&quot;tableName&quot;);
const query1 = query.equalTo(&quot;isLike&quot;, '&gt;', 150);
const query2 = query.equalTo(&quot;isLike&quot;, '&lt;', 150);

query.or(query1, query2);
query.find().then(res =&gt; {
  // 返回 isLike &gt; 150 or isLike &lt; 5 的值
  console.log(res)
});
</code></pre>

<p><strong>查询指定列</strong></p>
<pre><code>const query = Bmob.Query(&quot;tableName&quot;);
// 只返回select的字段值
query.select(&quot;title&quot;);
query.find().then(res =&gt; {
  // 返回成功
  console.log(res)
});
</code></pre>

<p><strong>复杂查询</strong></p>
<p>如果你想查询某一字段值在某一集合中的记录的话，可以使用<code>containedIn</code>方法，如获取<code>"Bmob"、"Codenow"、"JS"</code>这三位玩家的记录信息，那么示例代码如下</p>
<pre><code>// 第一个参数是字段名称，第二个参数是数组
query.containedIn(&quot;playerName&quot;, [&quot;Bmob&quot;, &quot;Codenow&quot;, &quot;JS&quot;]);
</code></pre>

<p>相反地，你可以使用<code>notContainedIn</code>方法来查询在集合外的目标对象。</p>
<p>如果想要查询含有某一特定属性的对象，可以使用<code>exists</code>。相对地，如果你想获取没有这一特定属性的对象，你可以使用<code>doesNotExist</code>，示例代码如下：</p>
<pre><code>// 查询含有score属性的对象
query.exists(&quot;score&quot;);

// 查询不含有score属性的对象
query.doesNotExist(&quot;score&quot;);
</code></pre>

<p><strong>分页查询</strong></p>
<p>有时，在数据比较多的情况下，你希望查询出的符合要求的所有数据能按照多少条为一页来显示，这时可以使用<code>limit</code>方法来限制查询结果的数据条数来进行分页。默认情况下，Limit的值为10，最大有效设置值1000（设置的数值超过1000还是视为1000）。</p>
<pre><code>// 返回最多10条数据
query.limit(10);
</code></pre>

<p>在数据较多的情况下，在<code>limit</code>的基础上分页显示数据是比较合理的解决办法，<code>skip</code>方法可以做到跳过查询的前多少条数据来实现分页查询的功能。默认情况下<code>skip</code>的值为10。</p>
<pre><code>query.skip(10); // skip the first 10 results
</code></pre>

<p><strong>结果排序</strong></p>
<p>我们可以对返回的结果进行排序（只支持<code>number</code>，<code>date</code>，<code>string</code>类型的排序），示例代码如下：</p>
<pre><code>// 对score字段升序排列
query.order(&quot;score&quot;);

// 对score字段降序排列
query.order(&quot;-score&quot;);

// 多个字段进行排序
query.order(&quot;-score&quot;,&quot;name&quot;);
</code></pre>

<p><strong>统计记录数量</strong></p>
<p>如果你只是想统计满足<code>query</code>的结果集到底有多条记录，你可以使用<code>count</code>方法。如为了获得diary表的记录数量，示例代码如下：</p>
<pre><code>const query = Bmob.Query('diary');
query.count().then(res =&gt; {
  console.log(`公有${res}条记录`)
});
</code></pre>

<h2 id="_20">数据库批量操作<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h2>
<p><strong>温馨提示： </strong> 为保障数据安全，此处所有批量操作数据库，单次最多为50条。</p>
<h3 id="_21">批量修改<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过查询条件批量修改符合条件记录</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>aab</td>
<td>string</td>
<td>否</td>
<td>列名称</td>
</tr>
<tr>
<td>bb</td>
<td>string</td>
<td>否</td>
<td>列名称</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
query.find().then(todos =&gt; {
  todos.set('aab', &quot;Bmob后端云&quot;);
  todos.set('bb', 'Bmob后端云');
  todos.saveAll().then(res =&gt; {
    // 成功批量修改
    console.log(res,'ok')
  }).catch(err =&gt; {
    console.log(err)
  });
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>[
(添加对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;createdAt&quot;: YYYY-mm-dd HH:ii:ss,
      &quot;objectId&quot;: &quot;d746635d0b&quot;
    }
  },
  (修改对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;updatedAt&quot;: YYYY-mm-dd HH:ii:ss
    }
  },
  (删除对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;msg&quot;: &quot;ok&quot;
    }
  }
]
</code></pre>

<h3 id="_22">批量增加<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>传入一个Query的数组，进行批量保存</p>
<pre><code>const queryArray = new Array();
// 构造含有50个对象的数组
for(var i = 0 ; i &lt; 50 ; i++){
  var queryObj = Bmob.Query('tableName');
  queryObj.set('columnName','abc' + i);
  queryArray.push(queryObj);
}


// 传入刚刚构造的数组
Bmob.Query('tableName').saveAll(queryArray).then(result =&gt; {
  console.log(result);
}).catch(err =&gt; {
  console.log(err);
});
</code></pre>

<p><strong>返回与批量修改一致: </strong></p>
<h3 id="_23">批量删除<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过查询条件批量修改符合条件记录</p>
<p><strong>参数说明：</strong></p>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
// 单词最多删除50条
query.limit(50)
query.find().then(todos =&gt; {

  todos.destroyAll().then(res =&gt; {
    // 成功批量修改
    console.log(res,'ok')
  }).catch(err =&gt; {
    console.log(err)
  });
})
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>[
(添加对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;createdAt&quot;: YYYY-mm-dd HH:ii:ss,
      &quot;objectId&quot;: &quot;d746635d0b&quot;
    }
  },
  (修改对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;updatedAt&quot;: YYYY-mm-dd HH:ii:ss
    }
  },
  (删除对象返回的信息)
  {
    &quot;success&quot;: {
      &quot;msg&quot;: &quot;ok&quot;
    }
  }
]
</code></pre>

<h2 id="_24">数据关联<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h2>
<h3 id="pointer">Pointer的使用<a class="headerlink" href="#pointer" title="Permanent link">&para;</a></h3>
<h4 id="pointer_1">查询Pointer<a class="headerlink" href="#pointer_1" title="Permanent link">&para;</a></h4>
<p><strong>简介：</strong></p>
<p>通过字段类型Pointer 查询出连表的内容，支持多个参数，连接多表</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>string</td>
<td>是</td>
<td>数据表名称</td>
</tr>
<tr>
<td>own</td>
<td>string</td>
<td>是</td>
<td>Pointer类型字段</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('tableName');
//下面参数为Pointer字段名称， 可以一次查询多个表
query.include('own','post')
query.find().then(res =&gt; {
    console.log(res)
  }).catch(err =&gt; {
    console.log(err)
  })
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
  &quot;results&quot;: [
    {
      key1:value1,
      key2:value2,
      ...
    },
    {
      key1:value1,
      key2:value2,
      ...
    },
    ...
}

</code></pre>

<h4 id="pointer_2">添加Pointer类型<a class="headerlink" href="#pointer_2" title="Permanent link">&para;</a></h4>
<p>简介：Pointer 类型在数据库是一个json数据类型，只需调用Pointer方法创建一个Pointer对象存入到字段中，如下：</p>
<pre><code>const pointer = Bmob.Pointer('_User')
const poiID = pointer.set('QdXD888B')
const query = Bmob.Query('test')
query.get('c02b7b018f').then(res =&gt; {
  res.set('own',poiID)
  res.save()
})

</code></pre>

<h4 id="pointer_3">删除Pointer类型<a class="headerlink" href="#pointer_3" title="Permanent link">&para;</a></h4>
<p>删除Pointer类型非常的简单，和删除普通的字段类型一样，如下：</p>
<pre><code>const query = Bmob.Query('test')
query.get('c02b7b018f').then(res =&gt; {
  res.unset('own')
  res.save()
})

</code></pre>

<h3 id="relation">Relation的使用<a class="headerlink" href="#relation" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>Relation 一对多，多对多表关联</p>
<h4 id="relation_1">添加Relation类型<a class="headerlink" href="#relation_1" title="Permanent link">&para;</a></h4>
<p><strong>请求示例：</strong></p>
<pre><code>const relation = Bmob.Relation('_User') // 需要关联的表
const relID = relation.add(['5PnCXXX6','QdXD888B']) //关联表中需要关联的objectId, 返回一个Relation对象, add方法接受string和array的类型参数
const query = Bmob.Query('test')
query.get('jzQMAAAO').then(res =&gt; {
  res.set('two',relID); // 将Relation对象保存到two字段中，即实现了一对多的关联
  res.save()
})
</code></pre>

<h4 id="relation_2">删除Relation类型<a class="headerlink" href="#relation_2" title="Permanent link">&para;</a></h4>
<p><strong>请求示例：</strong></p>
<pre><code>const relation = Bmob.Relation('_User')
const relID = relation.remove(['5PnCXXX6','QdXD888B'])
query.get('jzQMAAAO').then(res =&gt; {
  res.set('two',relID);
  res.save()
})

</code></pre>

<h4 id="relation_3">查询Relation类型<a class="headerlink" href="#relation_3" title="Permanent link">&para;</a></h4>
<p><code>field</code>方法接受两个参数，第一个需要查询的字段名称，第二个需要查询的字段的objectId
<code>relation</code>方法接受一个参数，字段关联的表名称
查询成功之后，会返回该字段关联的所有数据</p>
<p><strong>请求示例：</strong></p>
<pre><code>const query = Bmob.Query('abcd')
query.field('two','a312d300eb')
query.relation('_User').then(res =&gt; {
  console.log(res);
})
</code></pre>

<h2 id="_25">数组操作<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h2>
<p>为了帮你存储数组类数据，有三种操作你可以原子性地改动一个数组，这需要一个给定的 key：</p>
<ul>
<li><code>add</code>在一个数组的末尾加入一个给定的对象。</li>
<li><code>addUnique</code>只会把原本不存在的对象加入数组，所以加入的位置没有保证。
  比如, 我们想在数组"DiaryType"中加入日记类型：</li>
</ul>
<p><strong>添加数组：</strong></p>
<pre><code>const query = Bmob.Query('tableName')
query.add(&quot;DiaryType&quot;, [&quot;public&quot;]);
query.addUnique(&quot;DiaryType&quot;, [&quot;secret&quot;]);
query.save();
</code></pre>

<p><strong>更新数组：</strong></p>
<pre><code>const query = Bmob.Query('tableName')
query.get('ObjectId').then(res =&gt; {
  res.add(&quot;DiaryType&quot;, [&quot;public&quot;]);
  res.addUnique(&quot;DiaryType&quot;, [&quot;secret&quot;]);
  res.save();
})
</code></pre>

<p><strong>删除数组：</strong></p>
<pre><code>const query = Bmob.Query('tableName')
query.get('ObjectId').then(res =&gt; {
  res.remove(&quot;DiaryType&quot;, [&quot;secret&quot;]);
  res.save();
})
</code></pre>

<h2 id="_26">云函数使用<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h2>
<p><strong>简介：</strong></p>
<p>云函数调用</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>funcName</td>
<td>string</td>
<td>是</td>
<td>手机号</td>
</tr>
<tr>
<td>requestData</td>
<td>string</td>
<td>否</td>
<td>模板信息</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let params =　{
  funcName: 'hello',
  data: {
    name : 'bmob'
  }
}
Bmob.functions(params.funcName,params.data).then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});

</code></pre>

<p><strong>云函数示例:</strong></p>
<pre><code>  function onRequest(request, response, modules) {
      //获取SDK客户端上传的name参数
      var name = request.body.name;
      if(name == 'bmob')
        response.end('欢迎使用Bmob');
      else
        response.end('输入错误，请重新输入');
    }  

</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
    result: &quot;欢迎使用Bmob&quot;
}

</code></pre>

<h2 id="_27">文件<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h2>
<h3 id="web">WEB文件上传<a class="headerlink" href="#web" title="Permanent link">&para;</a></h3>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>fileName</td>
<td>string</td>
<td>是</td>
<td>文件名(带后缀)</td>
</tr>
<tr>
<td>file</td>
<td>Object</td>
<td>是</td>
<td>相应的文本或者二进制流</td>
</tr>
</tbody>
</table>
<p><strong>web请求示例：</strong></p>
<pre><code>// 在页面中创建一个 file input来允许用户选择磁盘上的文件
&lt;input type=&quot;file&quot; id=&quot;profilePhotoFileUpload&quot;  multiple=&quot;multiple&quot; &gt;
</code></pre>

<p>然后，在一个处理onchange的函数里，将文件加入上传队列进行批量操作：</p>
<pre><code>const fileUploadControl = document.getElementById('profilePhotoFileUpload');
fileUploadControl.onchange = () =&gt; {
  const pic = fileUploadControl.files
  let file
  for(let item of pic){
     file = Bmob.File(item.name, item);
  }
  file.save().then(res =&gt; {
    console.log(res.length);
    console.log(res);
  })
}
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>[&quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/e65172f540195fe880043cc74236e397.jpg&quot;}&quot;, &quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/5670bf6740385bca802f9c33beb69ab9.jpg&quot;}&quot;]

</code></pre>

<h3 id="_28">小程序文件上传<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>fileName</td>
<td>string</td>
<td>是</td>
<td>文件名(带后缀)</td>
</tr>
<tr>
<td>file</td>
<td>Object</td>
<td>是</td>
<td>相应的文本或者二进制流</td>
</tr>
</tbody>
</table>
<p>给页面上传按钮一个点击事件，这里使用了for，支持批量上传</p>
<pre><code>upload:function(){
    wx.chooseImage({
      success: function (res) {
        console.log(res)
        var tempFilePaths = res.tempFilePaths
        var file;
        for (let item of tempFilePaths) {
          console.log('itemn',item)
          file = Bmob.File('abc.jpg', item);
        }
        file.save().then(res =&gt; {
          console.log(res.length);
          console.log(res);
        })

      }
    })
  }
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>[&quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/e65172f540195fe880043cc74236e397.jpg&quot;}&quot;, &quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/5670bf6740385bca802f9c33beb69ab9.jpg&quot;}&quot;]

备注：

res.set('files',res[0])
</code></pre>

<h3 id="file">file对象关联<a class="headerlink" href="#file" title="Permanent link">&para;</a></h3>
<p>上传文件写入Bmob File字段，上面选择了2张图片，所以返回2个File对象，如果需要写到数据库，字段，一个File字段只能写入一张图，例如下面这样</p>
<pre><code>const file = [&quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/e65172f540195fe880043cc74236e397.jpg&quot;}&quot;, &quot;{&quot;cdn&quot;:&quot;upyun&quot;,&quot;filename&quot;:&quot;abc.jpg&quot;,&quot;url&quot;:&quot;http://…2018/05/07/5670bf6740385bca802f9c33beb69ab9.jpg&quot;}&quot;]
query.set('files',file[0])
query.save().then(res =&gt; {
  console.log(res)
})
</code></pre>

<h3 id="_29">文件删除<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>string或array</td>
<td>是</td>
<td>上传文件时返回的url</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>// 传入string是单个文件删除，传入array是批量删除
const del = Bmob.File();
const val =  [&quot;http://bmob-cdn-15009.b0.upaiyun.com/2018/05/02/aae4998a403e018680a7eff90852905e.jpg&quot;]
del.destroy(val).then(res =&gt; {
  console.log(res);
}).catch(err =&gt; {
  console.log(err)
})  
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{
  &quot;msg&quot;: &quot;ok&quot;
}
</code></pre>

<h2 id="_30">小程序操作<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h2>
<h3 id="_31">小程序一键登录<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过微信支持的code实现一键登录，登陆成功后会在本地缓存保存用户的信息，此代码一般写入到<code>app.js</code></p>
<p><strong>参数说明：</strong></p>
<p>无需传参数</p>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.User.auth().then(res =&gt; {
      console.log(res)
      console.log('一键登陆成功')

    }).catch(err =&gt; {
      console.log(err)
    });
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>成功：
{
    &quot;createdAt&quot;:&quot;2018-04-19 17:26:45&quot;,
    &quot;objectId&quot;:&quot;X43SIIIH&quot;,
    &quot;sessionToken&quot;:&quot;cc4fbcfd40583af980f4e6e52085adbf&quot;,
    &quot;updatedAt&quot;:&quot;2018-04-19 17:26:48&quot;,
    &quot;username&quot;:&quot;aaaaaa&quot;
}
</code></pre>

<h3 id="_32">小程序更新用户信息<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>2018年5月1号起，微信官方彻底废除<code>wx.getUserInfo</code> 函数，如需获取用户信息，请使用按钮获取。</p>
<blockquote>
<p>wxml：</p>
</blockquote>
<pre><code> &lt;button open-type=&quot;getUserInfo&quot; bindgetuserinfo=&quot;getUserInfo&quot;&gt; 获取头像昵称 &lt;/button&gt;
</code></pre>

<blockquote>
<p>js：</p>
</blockquote>
<pre><code>getUserInfo: function(e) {
    app.globalData.userInfo = e.detail.userInfo
    Bmob.User.upInfo(e.detail.userInfo)
    this.setData({
      userInfo: e.detail.userInfo,
      hasUserInfo: true
    })
  }
</code></pre>

<blockquote>
<p>wxml显示</p>
</blockquote>
<pre><code>&lt;image bindtap=&quot;bindViewTap&quot; class=&quot;userinfo-avatar&quot; src=&quot;{{userInfo.avatarUrl}}&quot; background-size=&quot;cover&quot;&gt;&lt;/image&gt;
      &lt;text class=&quot;userinfo-nickname&quot;&gt;{{userInfo.nickName}}&lt;/text&gt;
</code></pre>

<p><strong>参数说明：</strong></p>
<p>无需传参数</p>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.User.upInfo(e.detail.userInfo).then(result =&gt; {
      console.log(result)
    }).catch(err =&gt; {
      console.log(err)
    })
</code></pre>

<p><strong>返回示例:</strong></p>
<pre><code>{&quot;updatedAt&quot;:&quot;2018-05-02 14:43:26&quot;}
</code></pre>

<h3 id="_33">生成二维码<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过路径生成二维码图片</p>
<p><strong>参数说明：</strong></p>
<p>Bmob.generateCode 参数列表</p>
<table>
<thead>
<tr>
<th>键</th>
<th>值</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>pages/index/index</td>
<td>页面路径，支持参数</td>
</tr>
<tr>
<td>width</td>
<td>430</td>
<td>二维码宽度，这个参数微信规定不能少于180</td>
</tr>
<tr>
<td>interface</td>
<td>a\b\c</td>
<td>对应微信二维码abc方案</td>
</tr>
<tr>
<td>scene</td>
<td>Bmob</td>
<td>微信B方案才需要此值</td>
</tr>
<tr>
<td>type</td>
<td>0/1</td>
<td>默认0，返回二维码base64数据.如果为1则服务端返回为二维码网络路径</td>
</tr>
</tbody>
</table>
<p>更多微信官方小程序码介绍 <a href="https://mp.weixin.qq.com/debug/wxadoc/dev/api/qrcode.html" title="微信官方小程序码介绍">微信官方小程序码介绍</a></p>
<p><strong>请求示例：</strong></p>
<pre><code>let qrData = { path: 'path', width: width, type: 1 }
Bmob.generateCode(qrData).then(function (res) {
    console.log(res);
})
.catch(function (err) {
    console.log(err);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    cdn:&quot;upyun&quot;
    filename:&quot;code.jpg&quot;
    url:&quot;http://qrCodeImageURL.jpg&quot;
}
</code></pre>

<h3 id="access_token">获取access_token<a class="headerlink" href="#access_token" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>微信access_token，业务场景,当其他平台需要使用你小程序的token，并不想与Bmob的平台冲突，可以通过此API实现</p>
<p><strong>参数说明：</strong></p>
<p>无需参数</p>
<p><strong>请求示例：</strong></p>
<pre><code>Bmob.getAccessToken().then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    access_token: 'access_token'
}
</code></pre>
<h3 id="_34">小程序模版消息<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>小程序模板消息，通过传入模版，设置模版信息，需要在模版中设置多个参数(openId,templateId,formId)</p>
<p><strong>参数说明：</strong></p>
<p>参数在模版信息中传入</p>
<p><strong>请求示例：</strong></p>
<pre><code>let modelData = {
    "touser": "open_Id",
    "template_id": "template_id",
    "page": "index",
    "form_id":"form_Id",
    "data": {
        "keyword1": {
            "value": "SDK测试内容",
            "color": "#173177"
        },
        "keyword2": {
            "value": "2018年04月18日 16:30"
        },
        "keyword3": {
            "value": "Bmob科技"
        }
    }
    ,"emphasis_keyword": ""
}

Bmob.sendWeAppMessage(modelData).then(function (response) {
    console.log(response);
}).catch(function (error) {
    console.log(error);
});
</code></pre>
<hr />
<h3 id="_35">小程序付款到零钱<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<p>付款到零钱目前已经支持，常见使用场景是用户小程序里面提现，由于此接口用的人少，如需要使用可提交工单联系工作人员。</p>
<h3 id="_36">小程序支付<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>微信小程序支付，用户付款到微信支付账户。</p>
<p><strong>使用条件：</strong></p>
<ol>
<li>需企业用户提前开通微信支付</li>
<li>填写支付商户id到Bmob控制台</li>
<li>开通Bmob专业版或以上版本（可开通试用，工单联系）</li>
</ol>
<p><strong>参数说明：</strong></p>
<pre><code>var openId = wx.getStorageSync('openid');
//传参数金额，名称，描述,openid
    Bmob.Pay.weApp(0.01, '哇哈哈1瓶', '哇哈哈饮料，杭州生产', openId).then(function (resp) {
      console.log(resp);

      that.setData({
        loading: true,
        dataInfo: resp
      })

      //服务端返回成功
      var timeStamp = resp.timestamp,
        nonceStr = resp.noncestr,
        packages = resp.package,
        orderId = resp.out_trade_no,//订单号，如需保存请建表保存。
        sign = resp.sign;

      //打印订单号
      console.log(orderId);

      //发起支付
      wx.requestPayment({
        'timeStamp': timeStamp,
        'nonceStr': nonceStr,
        'package': packages,
        'signType': 'MD5',
        'paySign': sign,
        'success': function (res) {
          //付款成功,这里可以写你的业务代码
          console.log(res);
        },
        'fail': function (res) {
          //付款失败
          console.log('付款失败');
          console.log(res);
        }
      })

    }, function (err) {
      console.log('服务端返回失败');
      console.log(err);
    });
</code></pre>

<h3 id="_37">小程序退款<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>退款操作</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>order_no</td>
<td>string</td>
<td>是</td>
<td>订单编号</td>
</tr>
<tr>
<td>refund_fee</td>
<td>number</td>
<td>是</td>
<td>退款金额</td>
</tr>
<tr>
<td>desc</td>
<td>string</td>
<td>是</td>
<td>描述</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let data = {
    order_no: "order_no",
    refund_fee: fee,
    desc:"退款"
}
Bmob.refund(data).then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    code: 107,
    error: "content is empty."
}
</code></pre>
<h3 id="_38">微信主人通知<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>微信主动推送通知，业务场景：比如你有APP，有人下单了，或者有人留言了。你可以收到微信推送通知。每日限制50条，如需更多，请工单联系客服</p>
<p><strong>注意事项：</strong></p>
<p>此模板是Bmob 云提供，不可使用自己<code>template_id</code>，<code>openid</code>在Bmob后端云服务号回复<code>openid</code>拿到。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>touser</td>
<td>string</td>
<td>是</td>
<td>公众号openid</td>
</tr>
<tr>
<td>template_id</td>
<td>string</td>
<td>是</td>
<td>公众号 template_id</td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>是</td>
<td>用户点击网址</td>
</tr>
<tr>
<td>data</td>
<td>object</td>
<td>是</td>
<td>模板对应的格式</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let temp = {
  touser: "openid",
  template_id:"template_id",
  url: "http://www.bmob.cn/",
  data: {
        first: {
            value: "您好，Restful 失效，请登录控制台查看。",
            color: "#c00"
        },
        keyword1: {
            value: "Restful 失效"
        },
        keyword2: {
            value: "2017-07-03 16:13:01"
        },
        keyword3: {
            value: "高"
        },
        remark: {
            value: "如果您十分钟内再次收到此信息，请及时处理。"
        }
    }
}

Bmob.notifyMsg(temp).then(function (response) {
console.log(response);
})
.catch(function (error) {
console.log(error);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    msg: "ok"
}
</code></pre>
<h4 id="_39">提供模板<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h4>
<ol>
<li>新订单通知（template_id：<code>K9-6_Ayj4MLC2yvwY60-cq18tngJHAlqDfsOvv3D7a8</code> ）</li>
</ol>
<pre><code>{{first.DATA}}

提交时间：{{tradeDateTime.DATA}}
订单类型：{{orderType.DATA}}
客户信息：{{customerInfo.DATA}}
{{orderItemName.DATA}}：{{orderItemData.DATA}}
{{remark.DATA}}
</code></pre>

<ol>
<li>系统报警通知（template_id：<code>-ERkPwp0ntimqH39bggQc_Pj55a18CYLpj-Ert8-c8Y</code> ）</li>
</ol>
<pre><code>{{first.DATA}}
系统名称：{{keyword1.DATA}}
报警时间：{{keyword2.DATA}}
报警级别：{{keyword3.DATA}}
{{remark.DATA}}
</code></pre>

<ol>
<li>购买成功通知（template_id：<code>Mbk3kYqRGkL98ch6Lie4XSXtOsxXj2SC0SRQXd89G1Y</code>）</li>
</ol>
<pre><code>您好，您已购买成功。

商品信息：{{name.DATA}}
{{remark.DATA}}
</code></pre>

<ol>
<li>审核结果通知（template_id：<code>aNNNmi7WK4kohleWhCkDRKJiHOZnIpkrhXx5XPx4dx0</code> ）</li>
</ol>
<pre><code>{{first.DATA}}
账号名称：{{keyword1.DATA}}
审核状态：{{keyword2.DATA}}
审核时间：{{keyword3.DATA}}
{{remark.DATA}}
</code></pre>

<h3 id="_40">小程序下载域名<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<p>由于最近微信封了~~*.upaiyun.com~~ 域名，如果你没做文件下载功能，只是显示图片，可以不填写。如果你需要做下载功能，在应用设置里面，可以开启独立域名， 开启后，填写到微信平台就好了，当然有时候你想用自己的域名，也是可以的，可以工单联系我们。</p>
<h3 id="_41">小程序客服消息<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<p>经常有人有需求，希望手机端回复客户消息。这时，可以基于微信客服接口函数使用云函数开发相关功能， 如果你不想开发，希望自己小程序直接可用客服消息，可以使用Bmob官方提供的服务消息解决方案，主动提醒、自动回复、手机一键处理客服。如需使用请应用升级页面操作</p>
<h2 id="websocket">小程序WebSocket<a class="headerlink" href="#websocket" title="Permanent link">&para;</a></h2>
<p><strong>简介：</strong></p>
<p>小程序WebSocket主要用来做实时数据处理，例如实时监听订单表变化，聊天室等场景。（此业务每月99）</p>
<p>Bmob提供了数据实时功能，当开发者监听某个变化事件，例如监听表更新时，表的内容一旦变化，服务器就会通知SDK，SDK提供了相应回调函数来给开发者使用。当然开发者也可以取消相对应的监听，这样就不会收到数据变化的消息了。</p>
<h3 id="js">使用实时数据平台的js<a class="headerlink" href="#js" title="Permanent link">&para;</a></h3>
<p>对实时数据对象进行初始化</p>
<pre><code>let BmobSocketIo =new Bmob.Socket()
</code></pre>

<h3 id="_42">订阅事件<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<h4 id="_43">订阅表更新的事件<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<p>订阅表"GameScore"更新的事件。</p>
<pre><code>BmobSocketIo.updateTable(&quot;GameScore&quot;);
</code></pre>

<h4 id="_44">订阅行更新的事件<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h4>
<p>订阅表"GameScore"中行objectId为"3342e40e4f"更新的事件。</p>
<pre><code>BmobSocketIo.updateRow(&quot;GameScore&quot;,&quot;3342e40e4f&quot;);

</code></pre>

<h4 id="_45">订阅行删除的事件<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h4>
<p>订阅表"GameScore"中行objectId为"3342e40e4f"删除的事件。</p>
<pre><code>BmobSocketIo.deleteRow(&quot;GameScore&quot;,&quot;1256e40e4f&quot;);

</code></pre>

<h3 id="_46">取消订阅事件<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<h4 id="_47">取消订阅表更新的事件<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h4>
<p>取消订阅表"GameScore"更新的事件。</p>
<pre><code>BmobSocketIo.unsubUpdateTable(&quot;GameScore&quot;);

</code></pre>

<h4 id="_48">取消订阅行更新的事件<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h4>
<p>取消订阅表"GameScore"中objectId为"3342e40e4f"行更新的事件。</p>
<pre><code>BmobSocketIo.unsubUpdateRow(&quot;GameScore&quot;,&quot;3342e40e4f&quot;);

</code></pre>

<h4 id="_49">取消订阅行删除的事件<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h4>
<p>取消订阅表"GameScore"中objectId为"3342e40e4f"行删除的事件。</p>
<pre><code>BmobSocketIo.unsubDeleteRow(&quot;GameScore&quot;,&quot;1256e40e4f&quot;);

</code></pre>

<h3 id="_50">监听触发的事件<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h3>
<h4 id="_51">监听更新表的事件<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h4>
<p>当订阅了表更新的表数据发送变化时，js中会触发函数onUpdateTable。</p>
<p>tablename为更新的表，data为服务端返回的更新数据。</p>
<pre><code>   BmobSocketIo.onUpdateTable = function(tablename,data) {    
      //业务逻辑的代码
   };

</code></pre>

<h4 id="_52">监听行更新的事件<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h4>
<p>tablename为更新的表，objectId为更新行的objectId，data为服务端返回的更新数据。</p>
<pre><code>   BmobSocketIo.onUpdateRow = function(tablename,objectId,data) {    
      //业务逻辑的代码
   };

</code></pre>

<h4 id="_53">监听行删除的事件<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h4>
<p>tablename为更新的表，objectId为更新行的objectId，data为服务端返回的更新数据。</p>
<pre><code>   BmobSocketIo.onDeleteRow = function(tablename,objectId,data) {    
      //业务逻辑的代码
   };

</code></pre>

<h3 id="demo">demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h3>
<p>在线上演示实时数据平台的一个聊天应用的demo：<a href="http://chatroom.bmob.cn">chat room demo</a> ，演示了如何使用实时数据服务实现聊天的功能。</p>
<p>用浏览器打开两个窗口，在其中一个窗口输入<code>昵称</code>和<code>内容</code>，按<code>发送</code>按钮，在另外一个窗口能看到发送的内容。</p>
<p>小程序DEMO，搜索小程序：<strong>Bmob 示例 </strong></p>
<h2 id="_54">短信服务操作<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h2>
<h3 id="_55">请求短信验证码<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>使用特定的模板请求验证码，如果没有在管理后台创建好模板，可使用默认的模板，Bmob 默认的模板是: 您的验证码是%smscode%，有效期为%ttl%分钟。您正在使用%appname%的验证码</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>mobilePhoneNumber</td>
<td>string</td>
<td>是</td>
<td>手机号</td>
</tr>
<tr>
<td>template</td>
<td>string</td>
<td>否</td>
<td>模板信息</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let params = {
    mobilePhoneNumber: 'mobilePhoneNumber' //string
}
Bmob.requestSmsCode(params).then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>{
    smsId: smsId
}
</code></pre>
<h3 id="_56">验证短信验证码<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h3>
<p><strong>简介：</strong></p>
<p>通过以下接口，你可以验证用户输入的验证码是否是有效。</p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>必填</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>smsCode</td>
<td>string</td>
<td>是</td>
<td>手机短信验证码</td>
</tr>
<tr>
<td>mobilePhoneNumber</td>
<td>string</td>
<td>是</td>
<td>手机号码</td>
</tr>
</tbody>
</table>
<p><strong>请求示例：</strong></p>
<pre><code>let smsCode = 'smsCode'
let data = {
  mobilePhoneNumber: 'telephone'
}
Bmob.verifySmsCode(smsCode, data).then(function (response) {
    console.log(response);
})
.catch(function (error) {
    console.log(error);
});
</code></pre>
<p><strong>返回示例:</strong></p>
<pre><code>成功
{
    "msg":"ok"
}
失败
{
    code: 301,
    error: "手机号码必须是11位的数字"
}
</code></pre>
                </div>
            </div>
        </div>

        
            <script>var base_url = '../..';</script>
            <script src="../../js/jquery-1.10.2.min.js"></script>
            <script src="../../js/bootstrap-3.0.3.min.js"></script>
            <script src="../../js/highlight.pack.js"></script>
            <script src="../../js/main.js"></script>
            <script src="../../js/base.js"></script>

        <div id="go-top"><i class="fa fa-chevron-up"></i></div>
        <a href="https://docs.bmob.cn/data/Android/a_faststart/doc/index.html" id="back" target="_blank">返回 <br> 旧版</a>
    </body>

</html>